#!/bin/bash

function show_common_help() {
    cat << COMMONHELP
common flags that affect all aurora commands
-W, --WORKSPACE     Set the workspace where all the logs will be stored.
                    And Env variable can also be set using "export WORKSPACE=..."
                    to set the log directories.

COMMONHELP
}
function show_build_help() {
    cat << BUILDHELP
build
  Build a new image with given COMMIT-ID/TAG/LOCAL-CHANGES.
  -r, --refspec       [optional] Gerrit RefSpec. e.g. refs/changes/20/11020/1.
                      Not specifying a refspec will build an instance without any changes
                      on the specified branch.
  -p, --proj          Project with which commit belongs e.g. alps, pg_ui, pg_cli
  -b, --branch        Branch on which you want to test e.g. master, stable_4_0
  -C, --continue      [optional] --continue option will resume the script from the point where it
                      stopped (because of broken ssh connection or simply because you powered-off
                      your machine).
                      It is also useful in case script hits some failures. Rather than running
                      whole script from scratch, --continue switch will make sure to run only those
                      steps which had hit failures or had not been run at all.
  -k, --keep-running  [optional] Instance will be left running after aurora run ends.
  -t, --tag           [optional] Add a tag to the instance name. Useful if multiple build instances for the
                      same refspec are required.

BUILDHELP
}

function show_run_help() {
    cat << RUNHELP
run
  Run test script on cloud instance with aurora BUILD-ID.
  -l, --buildid         Build on which you want to run test.
  -s, --script          Test script which you want to run (please see sample_test1.sh to get further idea)
  -o, --log_dir         [optional] Directory where you want to keep test logs.
  -S, --skip-automaton  [optional] Skip running automaton-init.sh on the instance
  -K, --keep-running    [optional] Instance will be left running after aurora run ends.
  -C, --continue        [optional] --continue option will resume the script from the point where it
                        stopped (because of broken ssh connection or simply because you powered-off
                        your machine).
                        It is also useful in case script hits some failures. Rather than running
                        whole script from scratch, --continue switch will make sure to run only those
                        steps which had hit failures or had not been run at all.
  -n, --runid           To use along with --continue:
                        12 digit identifier for specific run (e.g e992a1fffaf8).
                        It is being printed out on screen immediately after you kick off the "aurora run"
                        first time.
                        It is part of your run-instance name as well [aurora ls instances].

RUNHELP
}

function show_init_help() {
   cat << INITHELP
init                Setup aurora environment.

                    During setup, when you are asked to "enter your gerrid id:"; enter only "gerrit-id" name which may differ from your email
                    address. For you email, you are prompted separately to "enter your plumgrid email:". An example is "username@plumgrid.com".
INITHELP
}

function show_upload_help() {
   cat << HELP
upload
  Upload some local file to docker container.
  -i, --instance      Instance name.
  -f, --file          Local file which you want to upload
  -d, --dest          Destination path where you want to upload

HELP
}

function show_download_help() {
   cat << HELP
download
  Download file from docker container to local machine.
  -i, --instance      Instance name.
  -f, --file          Remote file which you want to download
  -d, --dest          Destination path where you want to download.

HELP
}

function show_ls_help() {
   cat << HELP
ls
  List all currently active cloud instances or snapshots
  -e, --entity        Value can be:
                      instances: Lists all the instances running.
                      snapshots: Lists all the snapshots.
                      build_ids or build: Lists the build-ids and their corresponding RefSpec.
                      run_ids or run :   Lists the run instances and the corresponding build-ids.

HELP
}

function show_rm_help() {
   cat << HELP
rm
  -e, --entity        Value can be "instances", "snapshots" or "disks"
                      Default is "instances".
  -x, --regex         Regex to match. e.g "run" will delete all instances or snapshots
                      having 'run' as part of name.
HELP
}

function show_login_help() {
   cat << HELP
login
  Login to the specified instance
  aurora login <Instance name>

HELP
}

function show_pl_help() {
    cat << HELP
pipeline
  Run smoke/extended pipeline for some particular commit
  -l, --buildid             Build-ID against which you want to run pipeline
  -p, --pipeline            [OPTIONAL] The pipeline which you want to run.
                            Possible values are "smoke", "nightly".
                            Default is 'smoke'.
HELP
}
function show_set_max_instances_help() {
    cat << HELP
set_max_instances
  Change the number of concurrent instances allowed.
  -m, --max-instances       Max number of instances allowed
HELP
}

function show_help() {
  show_common_help
  show_init_help
  show_build_help
  show_run_help
  show_download_help
  show_upload_help
  show_ls_help
  show_rm_help
  show_ls_help
  show_login_help
  show_pl_help
}
